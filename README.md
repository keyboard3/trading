# 自定义量化交易程序

## 项目设置与运行 (Setup and Run)

为了运行本项目，建议遵循以下步骤设置环境并安装依赖：

### 1. 克隆仓库 (如果需要)
```bash
git clone https://github.com/keyboard3/trading.git
cd trading
```

### 2. 创建并激活虚拟环境 (推荐)
虚拟环境有助于隔离项目依赖，避免与系统全局Python环境或其他项目冲突。

使用 Python 3 自带的 `venv` 模块:
```bash
# 在项目根目录运行
python3 -m venv venv 
```
激活虚拟环境：
*   macOS / Linux:
    ```bash
    source venv/bin/activate
    ```
*   Windows (Git Bash 或其他类似shell):
    ```bash
    source venv/Scripts/activate 
    ```
*   Windows (Command Prompt):
    ```bash
    venv\Scripts\activate.bat
    ```
激活后，你的终端提示符前通常会显示 `(venv)`。

### 3. 安装依赖
项目所需的第三方库记录在 `requirements.txt` 文件中。在激活虚拟环境后，运行：
```bash
pip install -r requirements.txt
```
如果你没有使用虚拟环境，并且系统中使用 `pip3`，则运行 `pip3 install -r requirements.txt`。

### 4. 运行主程序
完成上述步骤后，你可以运行项目的主程序：
```bash
python3 main.py
```
程序将使用 `data/sample_stock_data.csv` 文件进行回测，并在 `results/` 目录下生成性能报告和图表。

### 5. (可选) 退出虚拟环境
当你完成工作后，可以停用虚拟环境：
```bash
deactivate
```

---

本项目旨在创建一个个性化的量化交易程序，方便验证各种交易策略并评估其收益。项目将通过网页UI的形式呈现策略回测效果和相关数据分析。

## 项目开发阶段 (Phased Development Plan)

为了逐步熟悉量化交易领域并有序地构建系统，本项目将采用分阶段迭代的开发方式。

### 阶段一：核心回测引擎与手动数据处理

*   **总目标**: 构建一个基础的回测框架，能够针对手动导入的数据（如CSV文件）运行简单的交易策略，并输出基本的回测结果。
*   **总体状态**: `✅ 已完成`
*   **主要模块与任务**:
    *   `✅` **1. 项目初始化与基本结构搭建**:
        *   **目的**: 建立项目的基础目录结构，初始化版本控制。
        *   **选型/工具**: Git。
        *   **产出**: 定义如 `data/`, `strategies/`, `core_engine/`, `results/`, `main.py` (或类似入口脚本) 的目录。
    *   `✅` **2. 数据输入模块**:
        *   **目的**: 实现从CSV文件加载和解析历史市场数据（例如：日期, 开盘价, 最高价, 最低价, 收盘价, 成交量 - OHLCV）。
        *   **选型/工具**: Python, [Pandas库](docs/pandas_intro.md)。
        *   **产出**: 一个能够读取指定格式CSV数据并转换为Pandas DataFrame的函数或类。
    *   `✅` **3. 简单策略模块**:
        *   **目的**: 实现至少一个基础的交易策略逻辑，例如[双均线交叉策略](docs/dual_ma_crossover_strategy.md)。策略应能接收市场数据并产生买入/卖出/持有的信号。
        *   **选型/工具**: Python。
        *   **产出**: `strategies/simple_ma_strategy.py` 中的函数，能够根据输入数据生成交易信号。
    *   `✅` **4. 核心回测引擎**:
        *   **目的**: 根据策略产生的信号，逐根K线模拟交易过程。管理简单的投资组合（现金、持仓），计算每日盈亏和资产净值。
        *   **选型/工具**: Python。
        *   **产出**: `core_engine/backtest_engine.py` 中的回测主循环逻辑，能够处理交易信号、更新投资组合状态。
    *   `✅` **5. 结果输出与初步分析模块**:
        *   **目的**: 计算并展示基本的回测绩效指标（例如：总收益率、年化收益率、最大回撤、夏普比率（简化版））。输出交易明细列表。
        *   **选型/工具**: Python, Matplotlib (用于绘制简单的净值曲线图)。
        *   **产出**: `core_engine/performance_analyzer.py` 中的函数，用于输出回测报告（文本，包含[最大回撤](docs/max_drawdown_explained.md)、[夏普比率](docs/sharpe_ratio_explained.md)等指标）、绘制净值曲线图。
    *   `✅` **6. 整合与测试**:
        *   **目的**: 将上述模块整合起来，形成一个可运行的简单回测流程，并进行初步测试。
        *   **选型/工具**: Python。
        *   **产出**: `main.py` 脚本，可以从数据输入到结果输出完整运行。
*   **学习重点**: 回测基本流程、策略如何用代码表达、Pandas数据处理、关键绩效指标(KPIs)的含义与计算、Matplotlib基础绘图。

### 阶段二：数据管理与策略库增强

*   **目标**: 引入更规范的数据存储方案，丰富策略库，并开始考虑简单的策略参数优化。
*   **主要模块**:
    *   数据存储模块 (e.g., SQLite, PostgreSQL)
    *   数据获取模块 (初步, e.g., 从免费API下载)
    *   增强的策略库 (支持参数化)
    *   回测引擎增强 (手续费, 滑点, 参数遍历)
    *   结果可视化增强
*   **学习重点**: 数据库操作, 数据获取, 多样化策略, 参数优化概念。

### 阶段三：Web UI 展示与交互

*   **目标**: 构建一个简单的 Web 界面，用于展示回测结果，并允许用户通过界面选择策略、设置参数、启动回测。
*   **主要模块**:
    *   后端 API 服务 (e.g., FastAPI, Flask)
    *   前端 Web UI (e.g., HTML/CSS/JS, 轻量级框架)
*   **学习重点**: Web后端开发, 前端开发, API设计。

### 阶段四：高级功能与优化 (可选)

*   **目标**: 引入更高级的策略、风险管理、实时数据处理和可能的模拟/实盘交易接口。
*   **主要模块**:
    *   实时数据流处理
    *   高级策略 (机器学习等)
    *   投资组合管理
    *   风险管理
    *   交易接口对接
    *   日志与监控
*   **学习重点**: 流式处理, 高级模型, 交易API, 系统监控。

---

详细的架构决策、技术选型和设计规范将在 `ARCHITECTURE.md` 文件中逐步记录和完善。
