# 最大回撤 (Max Drawdown, MDD)

最大回撤是在选定周期内，投资组合或资产价值从最高点回落到最低点的最大百分比损失。它被用来衡量策略或投资在历史上可能出现的最糟糕的连续亏损情况。

## 概念与重要性

最大回撤是一个重要的风险衡量指标，因为它帮助投资者了解在最不利的情况下，他们的投资组合可能面临多大的潜在损失。

*   **衡量下行风险**: 它关注的是从峰值到谷底的跌幅，而不是单一时期的损失。
*   **投资者心理承受能力**: 一个过大的最大回撤可能会超出投资者的风险承受能力，导致其在不恰当的时机退出投资。
*   **策略评估**: 在比较不同交易策略时，最大回撤是评估其风险特性的关键因素之一。通常，在相似的回报水平下，最大回撤较小的策略被认为风险控制更好。

## 如何计算（概念上）

计算最大回撤通常涉及以下步骤：

1.  **记录每日净值**: 获取投资组合在一段时间内的每日（或其他周期）的总价值。
2.  **计算累积最高点 (Peak)**: 对于每一个时间点，找出从开始到该时间点的历史最高净值。
3.  **计算回撤 (Drawdown)**: 对于每一个时间点，计算当前净值相对于同期历史最高点的回撤百分比。
    *   `回撤 = (当前净值 - 同期历史最高净值) / 同期历史最高净值`
    *   或者，更常见的是表示为正数损失：`回撤 = (同期历史最高净值 - 当前净值) / 同期历史最高净值`
4.  **找出最大回撤**: 在所有计算出的回撤值中，找到最大的那个回撤百分比。

例如，如果一个投资组合从100万增长到150万，然后跌至120万，之后回升到180万，再跌至135万。
*   第一次峰值是150万，谷底是120万，回撤是 `(150-120)/150 = 20%`。
*   第二次峰值是180万，谷底是135万，回撤是 `(180-135)/180 = 25%`。
那么，在此期间，最大回撤就是25%。

## 如何解读

*   **数值越小越好**: 最大回撤的绝对值越小，表明策略在历史上经历的最差连续亏损幅度越小，风险控制能力可能越强。
*   **没有绝对标准**: "好"的最大回撤值取决于投资者的风险偏好、策略类型和市场环境。一些高回报策略可能伴随着较高的最大回撤。
*   **结合其他指标**: 应结合总回报率、夏普比率等其他指标综合评估策略，而不是孤立地看待最大回撤。

在我们的程序中，`core_engine/performance_analyzer.py` 里的 `calculate_performance_metrics` 函数计算了最大回撤，并以百分比形式（通常为负数，表示损失）呈现在性能报告中。 